<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src *; script-src * 'unsafe-inline'; style-src * 'unsafe-inline';">
  <title>Training Material</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="tabs">
    <div class="tab" onclick="showTab('start-screen')" data-lang="start_quiz_tab">Démarrer le quiz</div>
    <div class="tab" onclick="showTab('edit-container')" data-lang="edit_questions_tab">Éditer Questions</div>
    <div class="tab" onclick="showTab('scores-container')" data-lang="scores_tab">Scores</div>
    <div class="tab" onclick="showTab('mermaid-editor-container')" data-lang="mermaid_editor_tab">Mermaid Live Editor</div>
    <div class="tab" onclick="showTab('converter-container')" data-lang="converter_tab">Convertisseur de Documents</div>
    <div class="tab" onclick="showTab('json-validator-container')" data-lang="json_validator_tab">Validateur JSON</div>
    <div class="tab" onclick="showTab('cicd-course-container')" data-lang="cicd_course_tab">Cours CI/CD</div>
    <div class="tab" onclick="showTab('logic-tests-container')" data-lang="logic_tests_tab">Défis Logiques et Soft Skills</div>
    <select id="language-selection" onchange="changeLanguage(this.value)">
      <option value="fr">Français</option>
      <option value="us">English</option>
    </select>
  </div>

  <div id="notification-banner" style="display: none;">
    <span id="notification-message"></span>
  </div>

  <div id="github-modal" style="display: none;">
    <div class="modal-content">
      <span id="modal-message"></span>
      <button id="modal-close-btn" data-lang="close">Fermer</button>
    </div>
  </div>

  <div id="start-screen">
    <h1 data-lang="welcome_message">Bienvenue sur Training Material</h1>
    <p>Date : <span id="current-date"></span></p>
    <div id="question-selection">
      <label for="candidate-name" data-lang="candidate_name"></label>
      <input type="text" id="candidate-name" placeholder="Entrez votre nom">
      <label for="lot-selection" data-lang="choose_lot"></label>
      <select id="lot-selection">
        <option value="" data-lang="choose_lot"></option>
      </select>
      <button id="start-quiz-button" data-lang="start_quiz"></button>
    </div>
    <div id="pat-section">
      <label for="github-pat" data-lang="github_pat"></label>
      <input type="text" id="github-pat" placeholder="Entrez votre PAT GitHub">
      <button id="validate-pat-btn" data-lang="validate_pat"></button>
      <span id="pat-status" style="display: none;" data-lang="pat_validated"></span>
      <button id="reset-pat-btn" style="display: none;" data-lang="reset_pat"></button>
      <div id="pat-feedback" style="display: none;"></div>
    </div>
  </div>

  <div id="quiz-container" style="display: none;">
    <div id="header">
      <div id="score-counter">
        Score : <span id="current-score">0</span> / <span id="total-questions">0</span> |
        Correctes : <span id="correct-count">0</span> |
        Incorrectes : <span id="incorrect-count">0</span>
      </div>
      <div id="timer">Temps : 00:00</div>
    </div>
    <button id="save-current-score-btn" data-lang="save_current_score"></button>
    <div id="save-current-feedback" style="display: none;"></div>
    <div id="questions-list"></div>
  </div>

  <div id="edit-container" style="display: none;">
    <h2 data-lang="edit_questions"></h2>
    <div class="edit-content">
      <div class="question-list-container">
        <div id="edit-filter">
          <label for="lot-filter" data-lang="filter_by_lot"></label>
          <select id="lot-filter">
            <option value="" data-lang="all_lots"></option>
          </select>
        </div>
        <div id="question-list"></div>
        <button onclick="addNewQuestion()" data-lang="add_question"></button>
      </div>
      <div id="pending-changes-sidebar" class="sidebar" style="display:none;">
        <h3>Modifications en attente</h3>
        <ul id="pending-changes-list"></ul>
        <button id="commit-all-changes-btn" onclick="commitAllChanges()">Commit All Changes</button>
      </div>
    </div>
  </div>

  <div id="scores-container" style="display: none;">
    <h2 data-lang="scores"></h2>
    <table id="scores-table">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Date</th>
          <th>Score</th>
          <th>Temps</th>
          <th>Lot</th>
        </tr>
      </thead>
      <tbody id="scores-body"></tbody>
    </table>
  </div>

  <div id="result" style="display: none;">
    <h2 data-lang="result"></h2>
    <p data-lang="score_message">Votre score : <span id="score"></span> / <span id="total-questions-result"></span></p>
    <button id="save-result-btn" data-lang="save_results"></button>
    <div id="save-result-feedback" style="display: none;"></div>
  </div>

  <!-- Mermaid Live Editor -->
  <div id="mermaid-editor-container" style="display: none;">
    <h2 data-lang="mermaid_editor_title">Mermaid Live Editor</h2>
    <div class="mermaid-editor">
      <textarea id="mermaid-input" data-lang-placeholder="mermaid_input_placeholder">
graph TD
    A-->B
    A-->C
    B-->D
    C-->D
      </textarea>
      <div id="mermaid-output"></div>
    </div>
    <div class="mermaid-actions">
      <button id="export-svg-button" data-lang="export_svg">Exporter en SVG</button>
      <button id="export-png-button" data-lang="export_png">Exporter en PNG</button>
    </div>
    <!-- Bouton pour afficher/masquer le cheat sheet -->
    <button id="mermaid-cheat-sheet-toggle" class="cheat-sheet-toggle" data-lang="mermaid_cheat_sheet_hide">Masquer l’aide</button>
    <!-- Section collapsible pour le cheat sheet, affichée par défaut -->
    <div id="mermaid-cheat-sheet" class="cheat-sheet" style="margin-top: 10px; padding: 10px; border: 1px solid #ccc; background-color: #f9f9f9;">
      <h3 data-lang="mermaid_cheat_sheet_title">Aide pour Mermaid Live Editor</h3>
      <p><strong data-lang="instructions">Instructions :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_instructions"></pre>
      <p><strong data-lang="basic_syntax">Syntaxe de base :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_basic_syntax"></pre>
      <p><strong data-lang="example_1">Exemple 1 : Diagramme de flux simple</strong></p>
      <pre data-lang="mermaid_cheat_sheet_example_1_title"></pre>
      <pre class="mermaid-example" data-lang="mermaid_cheat_sheet_example_1_code"></pre>
      <button class="insert-example" data-example="mermaid_cheat_sheet_example_1_code" data-lang="mermaid_cheat_sheet_insert_example_1">Insérer Exemple 1</button>
      <p><strong data-lang="example_2">Exemple 2 : Diagramme avec labels et styles de flèches</strong></p>
      <pre data-lang="mermaid_cheat_sheet_example_2_title"></pre>
      <pre class="mermaid-example" data-lang="mermaid_cheat_sheet_example_2_code"></pre>
      <button class="insert-example" data-example="mermaid_cheat_sheet_example_2_code" data-lang="mermaid_cheat_sheet_insert_example_2">Insérer Exemple 2</button>
      <p><strong data-lang="example_3">Exemple 3 : Diagramme de séquence</strong></p>
      <pre data-lang="mermaid_cheat_sheet_example_3_title"></pre>
      <pre class="mermaid-example" data-lang="mermaid_cheat_sheet_example_3_code"></pre>
      <button class="insert-example" data-example="mermaid_cheat_sheet_example_3_code" data-lang="mermaid_cheat_sheet_insert_example_3">Insérer Exemple 3</button>
      <p><strong data-lang="example_4">Exemple 4 : Diagramme de classes</strong></p>
      <pre data-lang="mermaid_cheat_sheet_example_4_title"></pre>
      <pre class="mermaid-example" data-lang="mermaid_cheat_sheet_example_4_code"></pre>
      <button class="insert-example" data-example="mermaid_cheat_sheet_example_4_code" data-lang="mermaid_cheat_sheet_insert_example_4">Insérer Exemple 4</button>
      <p><strong data-lang="example_5">Exemple 5 : Diagramme d’états</strong></p>
      <pre data-lang="mermaid_cheat_sheet_example_5_title"></pre>
      <pre class="mermaid-example" data-lang="mermaid_cheat_sheet_example_5_code"></pre>
      <button class="insert-example" data-example="mermaid_cheat_sheet_example_5_code" data-lang="mermaid_cheat_sheet_insert_example_5">Insérer Exemple 5</button>
      <p><strong data-lang="example_6">Exemple 6 : Diagramme de flux avec styles personnalisés</strong></p>
      <pre data-lang="mermaid_cheat_sheet_example_6_title"></pre>
      <pre class="mermaid-example" data-lang="mermaid_cheat_sheet_example_6_code"></pre>
      <button class="insert-example" data-example="mermaid_cheat_sheet_example_6_code" data-lang="mermaid_cheat_sheet_insert_example_6">Insérer Exemple 6</button>
      <p><strong data-lang="supported_types">Types de diagrammes supportés :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_supported_types"></pre>
      <p><strong data-lang="common_errors">Erreurs courantes à éviter :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_common_errors"></pre>
      <p><strong data-lang="styling_tips">Personnalisation et styles :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_styling_tips"></pre>
      <p><strong data-lang="use_cases">Cas d’utilisation :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_use_cases"></pre>
      <p><strong data-lang="tips">Astuces supplémentaires :</strong></p>
      <pre data-lang="mermaid_cheat_sheet_tips"></pre>
    </div>
  </div>

  <!-- Convertisseur de Documents -->
  <div id="converter-container" style="display: none;">
    <h2 data-lang="converter_title">Convertisseur de Documents</h2>
    <div class="converter">
      <label for="file-input" data-lang="converter_file_label">Charger un fichier :</label>
      <input type="file" id="file-input" accept=".docx,.pdf,.md">
      <label for="free-text-input" data-lang="converter_text_label">Ou entrez du texte libre :</label>
      <textarea id="free-text-input" data-lang-placeholder="converter_text_placeholder"></textarea>
      <div class="conversion-options">
        <label for="convert-from" data-lang="converter_from_label">Convertir depuis :</label>
        <select id="convert-from">
          <option value="docx">DOCX</option>
          <option value="pdf">PDF</option>
          <option value="markdown">Markdown</option>
        </select>
        <label for="convert-to" data-lang="converter_to_label">Convertir vers :</label>
                <select id="convert-to">
          <option value="html">HTML</option>
          <option value="markdown">Markdown</option>
          <option value="text">Texte brut</option>
        </select>
        <button id="convert-button" data-lang="converter_button">Convertir</button>
      </div>
      <div id="convert-output"></div>
    </div>
  </div>

  <!-- Validateur JSON -->
  <div id="json-validator-container" style="display: none;">
    <h2 data-lang="json_validator_title">Validateur JSON</h2>
    <div class="json-validator">
      <textarea id="json-input" data-lang-placeholder="json_input_placeholder"></textarea>
      <button id="validate-json-button" data-lang="json_validate_button">Valider JSON</button>
      <div id="json-output"></div>
    </div>
  </div>

  <!-- Cours CI/CD -->
  <div id="cicd-course-container" style="display: none;">
    <h2 data-lang="cicd_course_title">Cours CI/CD</h2>
    <div id="cicd-course-output" class="mkdocs-style"></div>
  </div>

  <!-- Défis Logiques et Soft Skills -->
  <div id="logic-tests-container" style="display: none;">
    <h2 data-lang="logic_tests_title">Défis Logiques et Soft Skills</h2>
    <div class="logic-tests">
      <div id="logic-test-list"></div>
      <div id="logic-test-content"></div>
      <div id="logic-test-result"></div>
    </div>
  </div>

  <script defer src="github.js"></script>
  <script defer src="quiz-core.js"></script>
  <script defer src="edit.js"></script>
  <script defer src="tools.js"></script>
  
  <script defer src="logic-tests.js?v=1" onload="console.log('logic-tests.js chargé avec succès');" onerror="console.error('Erreur lors du chargement de logic-tests.js. Vérifiez le chemin ou le contenu du fichier.');"></script>
  <script>
    // Vérifier si initializeLogicTests est défini après le chargement des scripts
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        if (typeof initializeLogicTests !== 'function') {
          console.error('initializeLogicTests n\'est pas défini après le chargement des scripts. Vérifiez que logic-tests.js est correctement chargé et qu\'il n\'y a pas d\'erreurs dans le fichier.');
        } else {
          console.log('initializeLogicTests est défini, prêt à être utilisé.');
        }
      }, 3000); // Augmenter le délai à 3 secondes pour laisser plus de temps aux scripts asynchrones
    });
  </script>
</body>
</html>
